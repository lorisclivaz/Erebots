(this["webpackJsonpcovid19-frontend"]=this["webpackJsonpcovid19-frontend"]||[]).push([[64],{591:function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return c}));var n=a(584),s=a(567);function r(e,t){return e.find((function(e){return e[n.b][s.b]===t}))}function i(e,t,a){for(var i=t;void 0!==i[n.c];){a(i=r(e,i[n.c][s.b]))}}function o(e){var t=e.find((function(e){return void 0===e[n.d]})),a=[];return a.push(t),i(e,t,(function(e){return a.push(e)})),a}function c(e,t){var a=0;return i(e,r(e,t),(function(e){return a++})),e.length-a}},853:function(e,t,a){},925:function(e,t,a){"use strict";a.r(t);var n=a(142),s=a(108),r=a(72),i=a(73),o=a(195),c=a(194),l=a(1),d=a.n(l),u=a(568),m=a(572),h=a(569),g=a(605),b=a(611),p=a(571),f=a(612),v=a(570),E=a(575),j=a(610),y=a(580),O=a(197),C=a(584),k=a(567),D=a(854),N=a.n(D),Q=a(583),S=a(591),L=a(109),w=a(53),P=(a(853),function(e){Object(o.a)(a,e);var t=Object(c.a)(a);function a(){return Object(r.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"getDragHeight",value:function(){return 32}},{key:"shouldComponentUpdate",value:function(e,t,a){return this.props.commonProps.hiddenDetails!==e.commonProps.hiddenDetails||this.props.commonProps.originalQuestions.length!==e.commonProps.originalQuestions.length||this.props.item[C.b][k.b]!==e.item[C.b][k.b]||this.props.itemSelected!==e.itemSelected}},{key:"render",value:function(){var e=this.props,t=e.item,a=e.itemSelected,n=e.dragHandleProps,s=.05*a+1,r=15*a+1;return d.a.createElement("div",{className:" dragged",style:{backgroundColor:"white",transform:"scale(".concat(s,")"),boxShadow:"rgba(0, 0, 0, 0.3) 0px ".concat(r,"px ").concat(2*r,"px 0px")}},d.a.createElement("div",Object.assign({className:"dragHandle"},n),d.a.createElement(u.a,null,d.a.createElement(m.a,null,d.a.createElement("b",null,"Level ",Object(S.a)(this.props.commonProps.originalQuestions,t[C.b][k.b])," \u2192 ",t[C.f])),d.a.createElement(h.a,{hidden:a>.4||this.props.commonProps.hiddenDetails},d.a.createElement(g.a,{className:"form-horizontal"},[C.h,C.g,C.e].map((function(e){var a=Object(Q.a)(e,C.a);return d.a.createElement(b.a,{row:!0,key:e},d.a.createElement(p.a,{md:"2"},d.a.createElement(f.a,null,d.a.createElement("i",null,a.keyPrettyNameLong,":"))),d.a.createElement(p.a,{xs:"12",md:"10"},d.a.createElement("p",{className:"form-control-static"},t[e]||d.a.createElement("span",{className:"text-muted"},"".concat(a.keyPrettyNameLong," ...")))))})))))))}}]),a}(l.Component)),x=function(e){Object(o.a)(l,e);var t=Object(c.a)(l);function l(e){var a;return Object(r.a)(this,l),(a=t.call(this,e)).allQuestions="allQuestions",a.fieldNames=[a.allQuestions],a.state=Object(n.a)(Object(n.a)({},Object(O.b)(a.fieldNames)),{},{draggableList:[],hiddenDetails:!0,uploadingChanges:!1,errorMessage:""}),a.onListChange.bind(Object(s.a)(a)),a}return Object(i.a)(l,[{key:"componentDidMount",value:function(){var e=this;Object(O.d)(this,this.allQuestions,y.p,{serverEndPoint:y.j},(function(t){return e.onListChange(Object(S.b)(t))}))}},{key:"onListChange",value:function(e){this.setState({draggableList:e})}},{key:"toggleHiddenDetails",value:function(){this.setState({hiddenDetails:!this.state.hiddenDetails})}},{key:"setErrorMessage",value:function(e){this.setState({uploadingChanges:!1,errorMessage:e}),window.scrollTo(0,0)}},{key:"sendChangesToServer",value:function(){var e=this;Object(w.b)("QuestionsReorder.js","Called sendChangesToServer",this.state.draggableList),this.setState({uploadingChanges:!0,errorMessage:""});var t=Object(S.b)(this.state["".concat(this.allQuestions,"Data")]);void 0===t&&Object(w.c)("QuestionsReorder.js","Hardcoded access to generic field is no more updated... change the line above");var a=t.some((function(t,a){return t[C.b][k.b]!==e.state.draggableList[a][C.b][k.b]}));if(Object(w.a)("QuestionsReorder.js","Will actually send changes to server? ",a),a){var n=this.state.draggableList.map((function(e,t,a){var n=new FormData;n.append(C.f,e[C.f]),n.append(C.h,e[C.h]),n.append(C.g,e[C.g]),n.append(C.e,e[C.e]),n.append(C.c,void 0===a[t+1]?"":a[t+1][C.b][k.b]),n.append(C.d,void 0===a[t-1]?"":a[t-1][C.b][k.b]);var s=e[C.b][k.b];return Object(y.v)(y.c,y.j,{id:s,formDataObject:n})}));Promise.all(n).then((function(t){Object(w.a)("QuestionsReorder.js","Saved changes to server:",t),e.setState({uploadingChanges:!1}),window.history.back()}),(function(t){Object(w.c)("QuestionsReorder.js","Error from server saving changes:",t.message),e.setErrorMessage(t.message)}))}else this.setState({uploadingChanges:!1}),window.history.back()}},{key:"render",value:function(){var e=this;return d.a.createElement("div",{className:"animated fadeIn"},d.a.createElement(v.a,null,d.a.createElement(p.a,{xl:12},d.a.createElement(u.a,null,d.a.createElement(m.a,null,d.a.createElement("i",{className:"fa fa-align-justify"})," Questions ",d.a.createElement("span",{className:"text-muted"},"(drag to reorder)"),d.a.createElement("div",{className:"card-header-actions"},d.a.createElement(E.a,{size:"sm",color:"secondary",onClick:this.toggleHiddenDetails.bind(this)},d.a.createElement("i",{className:"fa fa-list mr-2"}),this.state.hiddenDetails?"Show ":"Hide ","Details"))),d.a.createElement(h.a,null,Object(O.f)(this,this.allQuestions,(function(t){return d.a.createElement(N.a,{list:e.state.draggableList,itemKey:function(e){return e[C.b][k.b]},template:P,onMoveEnd:function(t){return e.onListChange(t)},container:function(){return document.body},commonProps:{hiddenDetails:e.state.hiddenDetails,originalQuestions:t}})}),Object(O.a)({}))),d.a.createElement(j.a,null,d.a.createElement("div",{className:"float-right"},d.a.createElement(E.a,{type:"submit",color:"primary",className:"mr-2",onClick:function(){return e.sendChangesToServer()},disabled:this.state.uploadingChanges},this.state.uploadingChanges?d.a.createElement("img",{className:"spinner",alt:"spinner",src:a(456)}):null,"Save changes"),d.a.createElement(L.Link,{to:"/home/modify/questions"},d.a.createElement(E.a,{color:"secondary",disabled:this.state.uploadingChanges},"Cancel"))))))))}}]),l}(l.Component);t.default=x}}]);
//# sourceMappingURL=64.53de4144.chunk.js.map